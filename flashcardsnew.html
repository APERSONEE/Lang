<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="icon" href="circular lang icon.png">
    <style>
        .mainContainer {
            height: 90vh;

            width: 100vw;
            justify-content: center;
            align-items: center;
            position: relative;

            /* overflow-x: hidden; */
            overflow: hidden;

        }

        .card {
            transition: opacity 0.5s ease-in-out;
            height: 400px;
            width: 600px;
            margin: 10px;

            display: inline-block;
            background-color: wheat;

            border-radius: 20px;

            box-sizing: border-box;
            padding: 20px;

            text-align: center;
        }

        @keyframes flipCard {
            0% {
                transform: rotateX(0deg);
            }
            50% {
                transform: rotateX(90deg);
            }
            100% {
                transform: rotateX(0deg);
            }
        }

        .cardContainer {
            transition: all 0.5s ease-out;
            position: absolute;
            /* top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); */

            transform: translateX(50vw) translateY(40vh);
        }

        .clicked {

        }

        .flipAnimation {
            animation: flipCard 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div id="header0" style="width: 100vw">
        <div class="horizontalFlex header">
            <div class="flexSpacer">
                <img style="height: 8vh; margin-left:10px;" src="assets/logos/lang-wheat.png">
            </div>

            <div class="flexSpacer" style="color: var(--primary-dark); text-align: center;">Flashcards</div>

            <div class="horizontalFlex flexSpacer" style="justify-content: flex-end;">
                <div id="homeusername">Loading</div>
                <div>
                    <img class="pfp" style="height: 5vh;" src="settings.png" onclick="window.location.href='settings.html'">
                </div>
            </div>
        </div>
    </div>

    <div class="horizontalFlex mainContainer" style="align-items: center; justify-content: center;">
        <!-- <div style="height: 20vh;"> -->
            <div id="cardContainer" class="absolute cardContainer"></div>

            <div class="horizontalFlex" style="margin-top: 450px; align-items: center; justify-content: center;">
                <div onclick="moveFlashcardsRight()" class="button centerText" style="background-color: var(--primary-light); color: var(--primary-dark)">
                    Previous
                </div>
                <div onclick="moveFlashcardsLeft()" class="button centerText" style="background-color: var(--primary-light); color: var(--primary-dark)">
                    Next
                </div>
            </div>
        <!-- </div> -->
    </div>

</body>
<script>
    var cardContainer = document.getElementById("cardContainer");
    var focusedCard = 0;
    var totalCardCount = 10;

    var cardWidth = 620;
    var cardHeight = 400;

    flashcardContentsArray = [
        ["front0", "back0"],
        ["front1", "back1"],
        ["front2", "back2"],
        ["front3", "back3"],
        ["front4", "back4"],
        ["front5", "back5"],
        ["front6", "back6"],
        ["front7", "back7"],
        ["front8", "back8"],
        ["front9", "back9"],
    ]

    function createFlashcards(count) {

        for (var i = 0; i < count; i++) {
            front = flashcardContentsArray[i][0];
            if (i == 0) {
                cardContainer.innerHTML += 
                    `<div style="opacity: 01; position: relative;" onclick="clickCard()" class="card">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                            ${front}
                        </div>
                    </div>`
            } else [
               cardContainer.innerHTML += 
                    `<div style="opacity: 0.5; position: relative;" onclick="clickCard()" class="card">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                            ${front}
                        </div>
                    </div>`
            ]
        }

        cardContainer.style.width = cardWidth * count + "px";
        cardContainer.style.left = -cardWidth / 2 + "px";
        cardContainer.style.top = -cardHeight / 2 + "px";
    }

    function moveFlashcardsLeft() {
        if (focusedCard + 1 >= totalCardCount) {
            cardContainer.children[focusedCard].style.opacity = 0.5;
            cardContainer.children[focusedCard].classList.remove("clicked");

            cardContainer.style.left = -cardWidth / 2 + "px";
            focusedCard = 0;
            cardContainer.children[focusedCard].style.opacity = 1;
            return;
        }

        cardContainer.children[focusedCard].style.opacity = 0.5;
        if (cardContainer.children[focusedCard].classList.contains("clicked")) {
            cardContainer.children[focusedCard].classList.add("flipAnimation");
        }
        cardContainer.children[focusedCard].classList.remove("clicked");

        const oldValue = focusedCard;
        setTimeout(function() {
            cardContainer.children[oldValue].children[0].innerHTML = flashcardContentsArray[oldValue][0];
        }, 250)
        setTimeout(function() {
            cardContainer.children[oldValue].classList.remove("flipAnimation");
        }, 500)

        focusedCard++;
        cardContainer.style.left = parseInt(cardContainer.style.left) - cardWidth + "px";

        cardContainer.children[focusedCard].style.opacity = 1;
    }

    function moveFlashcardsRight() {
        if (focusedCard - 1 < 0) {
            return;
        }
        cardContainer.children[focusedCard].style.opacity = 0.5;
        if (cardContainer.children[focusedCard].classList.contains("clicked")) {
            cardContainer.children[focusedCard].classList.add("flipAnimation");
        }
        cardContainer.children[focusedCard].classList.remove("clicked");

        const oldValue = focusedCard;
        setTimeout(function() {
            cardContainer.children[oldValue].children[0].innerHTML = flashcardContentsArray[oldValue][0];
        }, 250)
        setTimeout(function() {
            cardContainer.children[oldValue].classList.remove("flipAnimation");
        }, 500)

        focusedCard--;
        cardContainer.style.left = parseInt(cardContainer.style.left) + cardWidth + "px";

        cardContainer.children[focusedCard].style.opacity = 1;

    }

    var locked = false;

    function clickCard() {
        if (locked) {
            return;
        }
        locked = true
        var clickedCard = document.getElementById("cardContainer").children[focusedCard];
        var i = 0;
        if (clickedCard.classList.contains("clicked")) {
            clickedCard.classList.remove("clicked");
            i = 0
        } else {
            clickedCard.classList.add("clicked");
            i = 1
        }
        
        clickedCard.classList.add("flipAnimation");
        setTimeout(function() {
            clickedCard.classList.remove("flipAnimation");
            locked = false;
        }, 500);

        setTimeout(function() {
            clickedCard.children[0].innerHTML = flashcardContentsArray[focusedCard][i];
        }, 250)
    }

    createFlashcards(totalCardCount)
</script>
</html>